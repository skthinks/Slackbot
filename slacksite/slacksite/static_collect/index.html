<!DOCTYPE html>
<html>
<head>
        <title>Grofers Slack Leaderboard</title>

<script type="text/javascript"></script>
<style>
    table, th, td {
        border: 1px solid black;
        border-collapse: collapse;
    }
    th, td {
        padding: 5px;
    }
    </style>
</head>
        
<body style="background-color:lightgrey;">
    <h1 style="text-align:center; color:blue">Grofers Slack Leaderboard</h1>
    <div id="leaderboard"></div>
    <button type="button" onClick="getLeaderboard('monthly');">Monthly</button>
    <button type="button" onClick="getLeaderboard('weekly');">Weekly</button>       
<script>
    function getLeaderboardJSON(duration){
        var Httpreq = new XMLHttpRequest();
        if (duration == "monthly")
            Httpreq.open("GET", "http://7f06ef62.ngrok.io/slack/leaderboard/monthly",false);
        else            
             Httpreq.open("GET", "http://7f06ef62.ngrok.io/slack/leaderboard/weekly",false);
        Httpreq.send(null);
        return Httpreq.responseText;
   }
   
    function getLeaderboard(duration){
        var jsonObj = JSON.parse(getLeaderboardJSON(duration));
        returnTable = ("<table style=\"width:100%\">" +
            "<tr style=\"color:blue;\">" +
            "<th>Slacker</th>" +
            "<th>Holidays Taken</th>" +
            "<th>Late Arrivals</th>" +
            "<th>Early Departures</th>" +
            "</tr>"
        );
        for(i = 0; i < jsonObj.length; i++){
            console.log(jsonObj[i].name)
            returnTable += ("<tr style=\"color:blue;\">" +
                "<td>" + (jsonObj[i].name)  + "</td>" +
                "<td>" + JSON.stringify(jsonObj[i].on_leave)  + "</td>" +
                "<td>" + JSON.stringify(jsonObj[i].arrive_late)  + "</td>" +
                "<td>" + JSON.stringify(jsonObj[i].leave_early)  + "</td>" +
                "</tr>"
            );
        }
        returnTable += "</table>";
        console.log(returnTable)
        document.getElementById("leaderboard").innerHTML = returnTable;
    }
    getLeaderboard('weekly');
</script>
</body>
</html>

